# 도커의 기초

도커는 컨테이너형 가상화 기술(운영체제 수준 가상화)를 사용한다.

이전에는 LXC(Linux Containers)가 유명했는데, 도커도 초기에는 LXC를 런타임으로 사용(현재는 runC를 사용)했다.

---

Dockerfile이나 애플리케이션 실행 파일을 사용해서 도커 컨테이너의 원형이 될 이미지를 만드는 과정을 `도커 이미지 빌드`라고 한다.

## Dockerfile

도커가 어떻게 이미지를 만들고 실행할지가 여기에 정의된다.

### 도커 빌드 과정에서 쓰이는 명령어(빌드시에만 사용되고 캐시됨)

---

### From

컨테이너의 원형(틀) 역할을 할 도커 이미지(운영 체제)를 정의한다.

### COPY

파일을 복사하는데 사용

### RUN

도커 컨테이너 안에서 어떤 명령을 수행하기 위한것.

### 컨테이너 실행전 실행할 명령어

---

### CMD

이미지를 도커 컨테이너로 실행하기 전에 먼저 실행할 명령

## 도커이미지 빌드

    $ docker image build -t {IMAGE_NAME}:{TAG}

### 도커 이미지 실행

    $ docker container run {IMAGE_NAME}:{TAG}

## [LinuxKit](https://github.com/linuxkit/linuxkit)

---

윈도우/맥용 Docker는 LinuxKit을 경량 서브시스템으로 사용해 도커를 실행한다.

리눅스 서브 시스템을 제공하여 그 위에서 도커가 동작하도록 하는 형태로 VirtualBox를 경유하여 dockerd를 실행하던 기존의 방식을 해결하여, 오버헤드를 감소시킨다.

현재 도커 사가 주도로해서 리눅스 재단, MS, Intel, ARM, IBM 등과 함께 개발중이다.

## 도커를 사용하는 의의

---

### 환경 차이로 인한 문제 방지

---

1. 애플리케이션은 뭔가에 의존성을 갖게 되므로, 의존하는 환경의 차이를 가능한 한 배제하는것이 좋다.
2. 코드로 관리하는 인프라(Infrastructure as Code)와 불변 인프라(Immutable Infrastructure)
    1. 코드 기반으로 관리하는 인프라가 만병 통치약은 아니다.
    stable 버전이 변경될 수 있는 등의 항상 같은 결과가 보장되지 않기 때문에 멱등성을 확보할 수 있도록해야한다.
    → 어떤 시점의 서버상태를 저장해 복제할 수 있게 하자는 개념(서버 이미지 또는 스냅샷)으로 불변 인프라를 사용
    2. 도커를 활용하면 이 개념을 간단하고 낮은 비용으로 실현할 수 있다.
        1. 운영체제 대부분을 호스트 운영체제와 공유하기 때문에 실행에 걸리는 시간이 적어져 수정하지 않고 인프라를 완전히 새로 만드는 불변 인프라와 궁합이 잘 맞음
        2. Dockerfile로 서버 구성을 코드로 관리할 수 있기때문에, 기존 컨테이너를 빠르게 폐기하고 새로이 구축 할 수 있어 코드로 관리하는 인프라와 개념이 맞다
3. 애플리케이션과 인프라 묶어 구축하기

### 애플리케이션 구성 관리의 용이성

---

### 운영 환경에서 빛을 발하는 도커

### 새로운 개발 스타일
