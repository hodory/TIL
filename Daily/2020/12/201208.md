# 201208

동시성은 `무엇` 과 `언제`를 분리하는 전략.

단일 스레드로 처리를 하게 된다면, 이전 요청이 처리되기까지 기다리게 되는 병목현상이 생길 수 있다.

동시성이 항상 성능을 높여주는것은 아니다.<br/>
여러 스레드가 프로세서를 공유할 수 있거나, 독립적인 계산이 충분히 많은 경우에만 성능이 높아진다.

단일 스레드 시스템을 다중 스레드 시스템으로 변경하는데에는 큰 시스템 구조 변경이 필요하다.

웹과 EJB 컨테이너를 사용하더라도 동시 수정, 데드락과 같은 문제를 피할 수 있는지 고민해야한다.

또한 동시성은 성능측면에서 더 큰 부하를 줄 수 있다.<br/>
복잡하고, 버그가 발생하였을때 재현하기 더 어려우므로 일회성 문제라고 여기며 무시하기 쉽다.<br/>
동시성 구현에는 근본적 설계부터 재고해야한다.(같은 변수를 참조하는데 문제가 발생할 가능성이 있다.)

## 동시 방어 원칙

### 단일 책임원칙

동시성 코드는 다른 코드와 분리하여 복잡성을 낮춘다.

### 자료 범위 제한

자료를 캡슐화하여 공유하는 자료를 최소화한다. 그렇지 않으면 공유 자료를 수정하는 케이스에서 버그가 발생할 위험이 크다.

### 가능한 독립적인 스레드를 구현

가능하면 다른 프로세서에서 돌려도 괜찮도록 독립적 단위로 분할

## 라이브러리

실제 스레드 환경에 안전한 라이브러리와 컬렉션을 사용하도록한다.
Thread-Safe 하지 못한 라이브러리나 컬렉션이 존재할 수 있다.
